---
title: "Правила ревью кода в {{ mgl-name }}"
description: "{{ mgl-name }} позволяет гибко настраивать обязательные правила ревью кода, прежде чем он может быть добавлен в целевую ветку проекта. Функциональность является альтернативой встроенному в {{ GL }} Enterprise Edition инструменту Approval Rules и доступна вне зависимости от версии {{ GL }}."
---

# Правила ревью кода в {{ mgl-name }}

{% include [preview note](../../_includes/note-preview.md) %}

{{ mgl-name }} позволяет гибко настраивать обязательные правила ревью кода, прежде чем код может быть добавлен в целевую [ветку проекта](../../glossary/vcs.md#branch). Функциональность является альтернативой встроенному в {{ GL }} Enterprise Edition инструменту [Approval Rules](https://docs.gitlab.com/ee/user/project/merge_requests/approvals/rules.html) и доступна вне зависимости от [версии](https://about.gitlab.com/pricing) {{ GL }}.

Если в инстансе {{ GL }} включены правила ревью кода, {{ mgl-name }} анализирует подтверждения от ревьюеров на соответствие заданным правилам. Если подтверждений недостаточно, в мерж-реквесте создается техническая дискуссия, блокирующая его интеграцию в целевую ветку. При изменении мерж-реквеста в дискуссии создается или обновляется комментарий с текущим статусом соответствия правилам. Когда все необходимые подтверждения получены, дискуссия закрывается.

Если закрыть техническую дискуссию вручную, она будет создана заново. В случае интеграции мерж-реквеста в обход заданных правил пользователи с ролью `Maintainer` и выше получат уведомление на электронную почту о нарушении установленного процесса ревью кода.

Подробнее о работе с правилами ревью см. в разделе [Настройка правил ревью кода](../operations/approval-rules.md).

На стадии [Preview](../../overview/concepts/launch-stages.md) функциональность не тарифицируется.

## Токен {{ GL }} {#gitlab-token}

_[Токен {{ GL }}]({{ gl.docs }}/ee/user/profile/personal_access_tokens.html)_ нужен, чтобы настроить правила ревью кода. Токен запрашивается для авторизации при взаимодействии с репозиторием — так происходит обращение к API {{ GL }}.

Токен {{ GL }} обладает сроком жизни, который задается во время [создания токена](../operations/approval-rules.md#gitlab-token). Срок жизни истекает в полночь UTC в указанный день. Максимальный срок жизни — год с момента создания токена.

Накануне истечения срока {{ GL }} отправляет уведомление о том, что приближается окончание срока жизни токена. Уведомление приходит на электронную почту аккаунта, от лица которого был создан токен.

Выпустите новый токен и добавьте его в настройки инстанса {{ GL }} до того, как истечет срок жизни прежнего токена. Иначе сервис {{ mgl-name }} будет работать некорректно.

## Доступные конфигурации {#packages}

Вы можете выбрать нужную конфигурацию, исходя из задач команды:

* **Базовая** — включает возможность создания одного правила без дополнительных условий. Подходит для небольших команд (до 10 человек).
* **Стандартная** — позволяет настроить несколько правил и назначить [владельцев кода](../operations/approval-rules.md#code-ownership) (Code Owners) на определенные файлы или директории (не более 10 записей). Подходит для команд среднего размера (от 10 до 30 человек).
* **Продвинутая** — включает в себя возможности стандартной конфигурации без ограничения на количество записей Code Ownership и позволяет настраивать разные правила ревью для разных веток проекта. Подходит для больших команд (больше 30 человек).

Подробное сравнение возможностей конфигураций см. в таблице:

| Функциональность                  | Описание | Базовая<br>конфигурация | Стандартная<br>конфигурация | Продвинутая<br>конфигурация |
|:----------------------------------|:---------|:------------------------------------:|:---------------------------------------:|:------------------------------------:|
| Одно правило ревью                | Возможность выбрать группу пользователей, один из которых должен провести ревью перед объединением веток. | ![yes](../../_assets/common/yes.svg) | ![yes](../../_assets/common/yes.svg)    | ![yes](../../_assets/common/yes.svg) |
| Защищенные ветки                  | Возможность выбрать ветки, для которых действуют правила ревью. | ![yes](../../_assets/common/yes.svg) | ![yes](../../_assets/common/yes.svg)    | ![yes](../../_assets/common/yes.svg) |
| Code Ownership                    | Возможность закрепить определенные файлы и директории (в т. ч. по маске) за определенными пользователями. Такие пользователи становятся владельцами кода (code owners) и могут принимать участие в ревью, если коммиты в мерж-реквесте затрагивают их файлы. | ![no](../../_assets/common/no.svg)   | ![yes](../../_assets/common/yes.svg) | ![yes](../../_assets/common/yes.svg) |
| Несколько правил ревью            | Возможность задавать больше одного правила ревью. | ![no](../../_assets/common/no.svg)   | ![yes](../../_assets/common/yes.svg) | ![yes](../../_assets/common/yes.svg) |
| Правила для разных веток          | Возможность задавать разные правила ревью для разных веток, например `release` и `master`. | ![no](../../_assets/common/no.svg)   | ![no](../../_assets/common/no.svg)      | ![yes](../../_assets/common/yes.svg) |
